{"ast":null,"code":"// auction 전체 호출 (조건에 따라 필터링 호출)\n\nimport connectSupabase from \"./connectSupabase\";\n\n/**\r\n *\r\n * @param searchKeyword // 검색 키워드\r\n * @param categories // 카테고리\r\n * @param limit // 한번에 가져올 데이터 수\r\n * @param offset // 가져올 데이터 시작점\r\n * @param orderBy // 정렬 기준\r\n * @param order // 정렬 방식\r\n * @param user_id // 유저 아이디 (내가 쓴 글만 가져오기)\r\n */\nexport async function fetchGetAuctions(searchKeyword = \"\", categories, limit = 20, offset = 0, orderBy = \"created_at\", order = false, user_id = \"\") {\n  console.log(categories);\n  const query = connectSupabase.from(\"auction_post\").select(\"*, category(category_name), user_info(user_email)\").order(`${orderBy}`, {\n    ascending: order\n  });\n  searchKeyword.trim() !== \"\" && query.like(\"title\", `%${searchKeyword}%`).like(\"content\", `%${searchKeyword}%`);\n  user_id.trim() !== \"\" && query.eq(\"user_id\", user_id);\n  if (categories.length > 0) {\n    query.in(\"category_id\", categories);\n  }\n  const {\n    data,\n    error\n  } = await query.returns();\n  console.log(data);\n  if (error) throw new Error(error.message);\n  return data;\n}\nexport const fetchGetCategories = async () => {\n  const {\n    data,\n    error\n  } = await connectSupabase.from(\"category\").select(\"*\");\n  if (error) throw new Error(error.message);\n  return data;\n};\n\n/**\r\n * auction_id로 auction 데이터 호출\r\n * @param auction_id\r\n */\nexport const fetchGetAuctionById = async auction_id => {\n  const {\n    data,\n    error\n  } = await connectSupabase.from(\"auction_post\").select(`\n      *, auction_images(image_id, image_path),\n      category(category_name)`).eq(\"auction_id\", auction_id).returns().single();\n  if (error) throw new Error(error.message);\n  return data;\n};","map":{"version":3,"names":["connectSupabase","fetchGetAuctions","searchKeyword","categories","limit","offset","orderBy","order","user_id","console","log","query","from","select","ascending","trim","like","eq","length","in","data","error","returns","Error","message","fetchGetCategories","fetchGetAuctionById","auction_id","single"],"sources":["D:/Spart_Camp/auction_project/auction-project/src/api/auction.ts"],"sourcesContent":["// auction 전체 호출 (조건에 따라 필터링 호출)\r\nimport { Auction_post, Category } from \"../types/databaseRetrunTypes\";\r\nimport connectSupabase from \"./connectSupabase\";\r\n\r\n/**\r\n *\r\n * @param searchKeyword // 검색 키워드\r\n * @param categories // 카테고리\r\n * @param limit // 한번에 가져올 데이터 수\r\n * @param offset // 가져올 데이터 시작점\r\n * @param orderBy // 정렬 기준\r\n * @param order // 정렬 방식\r\n * @param user_id // 유저 아이디 (내가 쓴 글만 가져오기)\r\n */\r\nexport async function fetchGetAuctions(\r\n  searchKeyword: string = \"\",\r\n  categories: Category[],\r\n  limit: number = 20,\r\n  offset: number = 0,\r\n  orderBy: string = \"created_at\",\r\n  order: boolean = false,\r\n  user_id: string = \"\"\r\n) {\r\n  console.log(categories);\r\n  const query = connectSupabase\r\n    .from(\"auction_post\")\r\n    .select(\"*, category(category_name), user_info(user_email)\")\r\n    .order(`${orderBy}`, { ascending: order });\r\n\r\n  searchKeyword.trim() !== \"\" &&\r\n    query\r\n      .like(\"title\", `%${searchKeyword}%`)\r\n      .like(\"content\", `%${searchKeyword}%`);\r\n\r\n  user_id.trim() !== \"\" && query.eq(\"user_id\", user_id);\r\n\r\n  if (categories.length > 0) {\r\n    query.in(\"category_id\", categories);\r\n  }\r\n\r\n  const { data, error } = await query.returns<Auction_post[]>();\r\n  console.log(data);\r\n  if (error) throw new Error(error.message);\r\n\r\n  return data;\r\n}\r\n\r\nexport const fetchGetCategories = async () => {\r\n  const { data, error } = await connectSupabase.from(\"category\").select(\"*\");\r\n\r\n  if (error) throw new Error(error.message);\r\n  return data;\r\n};\r\n\r\n/**\r\n * auction_id로 auction 데이터 호출\r\n * @param auction_id\r\n */\r\nexport const fetchGetAuctionById = async (auction_id: string) => {\r\n  const { data, error } = await connectSupabase\r\n    .from(\"auction_post\")\r\n    .select(\r\n      `\r\n      *, auction_images(image_id, image_path),\r\n      category(category_name)`\r\n    )\r\n    .eq(\"auction_id\", auction_id)\r\n    .returns<Auction_post>()\r\n    .single();\r\n  if (error) throw new Error(error.message);\r\n\r\n  return data;\r\n};\r\n"],"mappings":"AAAA;;AAEA,OAAOA,eAAe,MAAM,mBAAmB;;AAE/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,eAAeC,gBAAgBA,CACpCC,aAAqB,GAAG,EAAE,EAC1BC,UAAsB,EACtBC,KAAa,GAAG,EAAE,EAClBC,MAAc,GAAG,CAAC,EAClBC,OAAe,GAAG,YAAY,EAC9BC,KAAc,GAAG,KAAK,EACtBC,OAAe,GAAG,EAAE,EACpB;EACAC,OAAO,CAACC,GAAG,CAACP,UAAU,CAAC;EACvB,MAAMQ,KAAK,GAAGX,eAAe,CAC1BY,IAAI,CAAC,cAAc,CAAC,CACpBC,MAAM,CAAC,mDAAmD,CAAC,CAC3DN,KAAK,CAAE,GAAED,OAAQ,EAAC,EAAE;IAAEQ,SAAS,EAAEP;EAAM,CAAC,CAAC;EAE5CL,aAAa,CAACa,IAAI,CAAC,CAAC,KAAK,EAAE,IACzBJ,KAAK,CACFK,IAAI,CAAC,OAAO,EAAG,IAAGd,aAAc,GAAE,CAAC,CACnCc,IAAI,CAAC,SAAS,EAAG,IAAGd,aAAc,GAAE,CAAC;EAE1CM,OAAO,CAACO,IAAI,CAAC,CAAC,KAAK,EAAE,IAAIJ,KAAK,CAACM,EAAE,CAAC,SAAS,EAAET,OAAO,CAAC;EAErD,IAAIL,UAAU,CAACe,MAAM,GAAG,CAAC,EAAE;IACzBP,KAAK,CAACQ,EAAE,CAAC,aAAa,EAAEhB,UAAU,CAAC;EACrC;EAEA,MAAM;IAAEiB,IAAI;IAAEC;EAAM,CAAC,GAAG,MAAMV,KAAK,CAACW,OAAO,CAAiB,CAAC;EAC7Db,OAAO,CAACC,GAAG,CAACU,IAAI,CAAC;EACjB,IAAIC,KAAK,EAAE,MAAM,IAAIE,KAAK,CAACF,KAAK,CAACG,OAAO,CAAC;EAEzC,OAAOJ,IAAI;AACb;AAEA,OAAO,MAAMK,kBAAkB,GAAG,MAAAA,CAAA,KAAY;EAC5C,MAAM;IAAEL,IAAI;IAAEC;EAAM,CAAC,GAAG,MAAMrB,eAAe,CAACY,IAAI,CAAC,UAAU,CAAC,CAACC,MAAM,CAAC,GAAG,CAAC;EAE1E,IAAIQ,KAAK,EAAE,MAAM,IAAIE,KAAK,CAACF,KAAK,CAACG,OAAO,CAAC;EACzC,OAAOJ,IAAI;AACb,CAAC;;AAED;AACA;AACA;AACA;AACA,OAAO,MAAMM,mBAAmB,GAAG,MAAOC,UAAkB,IAAK;EAC/D,MAAM;IAAEP,IAAI;IAAEC;EAAM,CAAC,GAAG,MAAMrB,eAAe,CAC1CY,IAAI,CAAC,cAAc,CAAC,CACpBC,MAAM,CACJ;AACP;AACA,8BACI,CAAC,CACAI,EAAE,CAAC,YAAY,EAAEU,UAAU,CAAC,CAC5BL,OAAO,CAAe,CAAC,CACvBM,MAAM,CAAC,CAAC;EACX,IAAIP,KAAK,EAAE,MAAM,IAAIE,KAAK,CAACF,KAAK,CAACG,OAAO,CAAC;EAEzC,OAAOJ,IAAI;AACb,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}